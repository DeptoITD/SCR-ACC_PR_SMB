; ============================================================
; Sistema Declarativo ACL - Reglas por perfil para:
; /srv/samba/02_Proyectos/<PROYECTO>/01_WIP/<ESPECIALIDAD>
;
; REQUISITO: "Lo que no edita NO lo ve (ni lo lista / ni aparece)"
; MODELO: DENY-BY-DEFAULT
;
; PRINCIPIOS:
; 1) Solo se otorgan permisos en carpetas listadas en "write".
; 2) En 01_WIP, perfiles restringidos reciben SOLO 'x' (traverse):
;    - Pueden entrar a sus carpetas si tienen permiso directo,
;      pero NO pueden listar el contenido de WIP.
; 3) BIM puede listar y entrar a todas las carpetas del WIP.
; 4) Para evitar "apariciones" por ACLs antiguas, se debe purgar ACL previa
;    del perfil en rutas no autorizadas (si el motor lo soporta).
; ============================================================

[GLOBAL]
root=/srv/samba/02_Proyectos
project_glob=*
wip_folder=01_WIP

; Nivel proyecto: ver y entrar al proyecto (listado general)
base_project=rx

; Nivel WIP:
; - Perfiles restringidos: solo traverse (NO listar especialidades)
base_wip=x

; (Opcional, recomendado) Normalización de permisos al aplicar "write"
; Directorios editables: rwx
; Archivos editables: rw-
write_dir=rwx
write_file=rw-

; (Opcional, recomendado) Defaults para herencia dentro de carpetas editables
default_dir=rwx
default_file=rw-

; (Opcional, recomendado) Purgar ACLs antiguas del perfil en carpetas NO autorizadas
; Esto es lo que evita que “aparezcan” carpetas por residuos de ACLs viejas.
purge_profile_acls=1


; ============================================================
; PERFIL: IND_A (Arquitectura)
; Visualización y edición SOLO en:
; A_ARQ, O_LEV, YAC_ACU, YPA_PAT, YPM_PTR, YSE_SEN, YSH_SGH
; ============================================================
[IND_A]
base_project=rx
base_wip=x
write=A_ARQ,O_LEV,YAC_ACU,YPA_PAT,YPM_PTR,YSE_SEN,YSH_SGH


; ============================================================
; PERFIL: IND_E (Estructura)
; Visualización y edición SOLO en:
; E_EST, O_LEV
; ============================================================
[IND_E]
base_project=rx
base_wip=x
write=E_EST,O_LEV


; ============================================================
; PERFIL: IND_YTP (Geotecnia)
; Visualización y edición SOLO en:
; YTP_TOP, A_ARQ, O_LEV, YAC_ACU, YPA_PAT, YPM_PTR, YSE_SEN, YSH_SGH, E_EST
; ============================================================
[IND_YTP]
base_project=rx
base_wip=x
write=YTP_TOP,A_ARQ,O_LEV,YAC_ACU,YPA_PAT,YPM_PTR,YSE_SEN,YSH_SGH,E_EST


; ============================================================
; PERFIL: IND_B (BIM)
; Visualización y edición en:
; TODAS LAS CARPETAS del WIP del proyecto
;
; Nota: BIM sí debe poder LISTAR WIP (rx) y entrar a todo sin saber nombres.
; ============================================================
[IND_B]
base_project=rx
base_wip=rx
wip_full_control=rwx
default_dir=rwx
default_file=rw-


; ============================================================
; Catálogo de especialidades (referencial)
; ============================================================
[SPECIALTIES]
A_ARQ
B_BIM
D_DET
E_EST
F_PCI
F_RCI
G_GEN
G_PMO
H_HID
I_GAS
L_ELE
M_MEC
O_LEV
R_REC
T_TEL
YAC_ACU
YBI_BIO
YGE_GEO
YIL_ILU
YPA_PAT
YPM_PTR
YSC_SyC
YTP_TOP
YVU_VUL
YSE_SEN
YSH_SGH
